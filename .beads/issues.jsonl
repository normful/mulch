{"id":"mulch-0fj","title":"Add mulch sync command","description":"One command that validates records, stages .mulch/ changes, and commits. Instead of the 3-step dance (mulch validate, git add .mulch/, git commit), agents run mulch sync and it's done. Keep it simple: validate → git add .mulch/ → git commit with standard message. No daemon, no auto-push (agents can push themselves). Just reduce friction of the session-end workflow.","status":"closed","priority":2,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-10T10:14:54.773545-08:00","created_by":"Jaymin West","updated_at":"2026-02-10T10:38:13.691063-08:00","closed_at":"2026-02-10T10:38:13.691063-08:00","close_reason":"Added mulch sync: validates records, git add .mulch/, git commit. Options: --message, --no-validate. Supports --json. Checks for git repo, handles no-changes case."}
{"id":"mulch-26n","title":"mulch prime should accept optional domain argument to scope output","description":"Currently mulch prime always outputs all domains. Add an optional positional argument (e.g. mulch prime cli) to output only that domain's expertise. Reduces context overload when agents only need one domain. Should validate the domain exists in config and error if not found.","status":"closed","priority":2,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-09T16:52:43.330753-08:00","created_by":"Jaymin West","updated_at":"2026-02-09T16:55:03.101817-08:00","closed_at":"2026-02-09T16:55:03.101817-08:00","close_reason":"Added optional [domain] positional argument to mulch prime. Validates domain exists in config, errors with available domains if not found. Updated README, .mulch/README, and init template. 4 new tests."}
{"id":"mulch-2jf","title":"Compact prime mode (--compact)","status":"closed","priority":2,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-09T17:23:16.254507-08:00","created_by":"Jaymin West","updated_at":"2026-02-09T17:25:39.782813-08:00","closed_at":"2026-02-09T17:25:39.782813-08:00","close_reason":"Closed"}
{"id":"mulch-2vn","title":"Stable hash-based record IDs","description":"Replace 1-based JSONL line indices with stable short hashes (e.g. mx-a1b2). Current line-index IDs shift when records are deleted or reordered. Agents need stable references to update, link, and discuss specific records across sessions. Generate from content hash or random UUID at record creation time. Edit/delete by hash ID instead of line number.","status":"closed","priority":2,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-10T10:14:39.434907-08:00","created_by":"Jaymin West","updated_at":"2026-02-10T10:35:07.372752-08:00","closed_at":"2026-02-10T10:35:07.372752-08:00","close_reason":"Added stable hash-based record IDs (mx-XXXXXX). Content-based SHA-256 hashing. Optional id field on BaseRecord + all 6 schema variants. Auto-generated in appendRecord/writeExpertiseFile. Edit command accepts ID or 1-based index. Lazy migration for existing records. 221 tests pass."}
{"id":"mulch-3kg","title":"Deduplication and idempotent recording","description":"mulch record always appends. Agents calling mulch record at session end will re-discover the same patterns and create duplicates. Need: (1) content-based dedup — skip if similar record exists, (2) named upsert — mulch record --name 'wal-mode' ... updates if exists, creates if not, (3) basic --if-not-exists flag. Without this, re-running seeding scripts or repeated agent sessions cause unbounded growth.","design":"Two dedup shapes: (A) exact re-discovery, (B) refined re-discovery. Named types (pattern/decision): upsert by name/title — if existing record matches, replace in place. Unnamed types (convention/failure): exact content/description match skips with message. --force flag overrides. ~30 lines in record command. No LLM needed.","status":"closed","priority":2,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-09T17:01:57.836585-08:00","created_by":"Jaymin West","updated_at":"2026-02-09T17:08:54.51354-08:00","closed_at":"2026-02-09T17:08:54.51354-08:00","close_reason":"Added dedup to mulch record. Named types (pattern/decision) upsert by name/title. Unnamed types (convention/failure) skip on exact content match. --force flag overrides. 10 new tests."}
{"id":"mulch-3m8","title":"Add reference and guide record types","description":"Current record types (convention/pattern/failure/decision) miss two common expertise categories: (1) key_files / reference — 'this file matters because...' e.g. 'app/src/mcp/tools.ts is the MCP tool definitions file', (2) key_operations / guide — step-by-step procedures like 'how to add an MCP tool'. These are frequently needed by agents and don't map cleanly to existing types.","design":"Two new record types: (1) reference — 'this file/concept matters because...', required fields: name, description, optional files array. (2) guide — 'here's how to do X', required fields: name, description. Both get classification like other types. reference is pattern-oriented around what matters; guide is convention-like but procedural. Simple schema additions.","status":"closed","priority":2,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-09T17:02:00.192715-08:00","created_by":"Jaymin West","updated_at":"2026-02-09T17:17:07.471479-08:00","closed_at":"2026-02-09T17:17:07.471479-08:00","close_reason":"Closed"}
{"id":"mulch-41r","title":"Add record deletion support","description":"There is no way to delete a record through the CLI. mulch edit has no --delete flag, and there is no mulch delete command. When an agent creates a junk record or needs to clean up, it has to manually edit the JSONL file. This is an agent-hostile gap. Add either: (a) mulch edit \u003cdomain\u003e \u003cindex\u003e --delete, or (b) a dedicated mulch delete \u003cdomain\u003e \u003cindex\u003e command. Should output JSON confirmation of what was deleted.","status":"closed","priority":1,"issue_type":"bug","owner":"jayminwest@gmail.com","created_at":"2026-02-10T10:35:22.367087-08:00","created_by":"Jaymin West","updated_at":"2026-02-10T10:42:23.884773-08:00","closed_at":"2026-02-10T10:42:23.884773-08:00","close_reason":"Added mulch delete command with ID and index support, JSON output, and 5 tests"}
{"id":"mulch-4nt","title":"Add --json flag to all commands","description":"Every mulch command should support --json for structured output. Currently only prime --mcp gives JSON. Agents need machine-readable output from search, status, query, record, edit, validate, prune — all of them. This is table stakes for agent tooling. Implementation: add a global --json flag, have each command output JSON when set. Keep human-readable as default.","status":"closed","priority":1,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-10T10:14:27.317199-08:00","created_by":"Jaymin West","updated_at":"2026-02-10T10:34:49.880955-08:00","closed_at":"2026-02-10T10:34:49.880955-08:00","close_reason":"Already implemented — --json flag works on all commands"}
{"id":"mulch-64w","title":"Provider-optimized prime output (XML for Claude, plain text for Codex)","description":"Design spec says Claude gets XML tags, Cursor gets markdown, Codex gets plain text. formatPrimeOutput currently only outputs markdown. Add --format flag or detect provider from setup config.","status":"closed","priority":3,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-09T16:37:26.04373-08:00","created_by":"Jaymin West","updated_at":"2026-02-09T16:42:31.364378-08:00","closed_at":"2026-02-09T16:42:31.364378-08:00","close_reason":"Added --format flag with xml (Claude-optimized), plain (Codex-optimized), and markdown (default). XML uses proper escaping and Claude-preferred tag structure."}
{"id":"mulch-7hy","title":"Record compaction (semantic decay)","description":"Instead of hard-deleting old records via prune, compact them: summarize N old records of the same type into 1 consolidated record. Agent-driven — mulch compact --analyze outputs candidates, agent provides the summary, mulch compact --apply writes it. Mulch does no LLM work, just bookkeeping. Similar to bd compact's analyze/apply workflow. Prevents knowledge loss while keeping context window small.","status":"open","priority":3,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-10T10:14:58.841347-08:00","created_by":"Jaymin West","updated_at":"2026-02-10T10:14:58.841347-08:00"}
{"id":"mulch-7pr","title":"Record linking and relations","description":"Let records reference each other with lightweight semantics: relates_to and supersedes. A failure can link to the pattern that fixed it. A convention can supersede an older convention. Not a full graph — just optional fields on records. Agents can follow knowledge chains: 'this failure led to this pattern' or 'this convention replaced that one'. Requires stable record IDs (mulch-4nt prerequisite: hash IDs).","status":"open","priority":2,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-10T10:14:45.404346-08:00","created_by":"Jaymin West","updated_at":"2026-02-10T10:14:45.404346-08:00","dependencies":[{"issue_id":"mulch-7pr","depends_on_id":"mulch-2vn","type":"blocks","created_at":"2026-02-10T10:15:04.499526-08:00","created_by":"Jaymin West"}]}
{"id":"mulch-8wp","title":"Add mulch learn command","description":"Session-end helper that outputs changed files from the last commit/diff to help agents decide what to record. Dead simple — no parsing, no inference, no LLM. Just: list changed files, list touched domains (from file paths in existing records), and prompt the agent to record learnings. The agent does the heavy lifting of deciding what's worth recording. Think: git diff --stat but formatted as a nudge.","status":"closed","priority":2,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-10T10:14:43.619618-08:00","created_by":"Jaymin West","updated_at":"2026-02-10T10:46:11.845581-08:00","closed_at":"2026-02-10T10:46:11.845581-08:00","close_reason":"Added mulch learn command: shows changed files, matches to domains via record files fields, suggests where to record learnings. 6 tests."}
{"id":"mulch-9gb","title":"Fix flaky prune boundary test (tactical 14-day edge)","description":"test/commands/prune.test.ts 'tactical record exactly at boundary (14 days) is not pruned' fails intermittently. daysAgo(14) plus milliseconds of clock drift makes age 14.0000001, passing the \u003e 14 check. Fix: Math.floor the age-in-days computation in prune so boundary records are treated as exactly N whole days old.","status":"closed","priority":2,"issue_type":"bug","owner":"jayminwest@gmail.com","created_at":"2026-02-09T17:18:45.208441-08:00","created_by":"Jaymin West","updated_at":"2026-02-09T17:20:49.425797-08:00","closed_at":"2026-02-09T17:20:49.425797-08:00","close_reason":"Closed"}
{"id":"mulch-ecu","title":"Record relationships: tags and grouping","description":"Records are flat and isolated. A decision often explains why a convention exists; a failure often leads to a new pattern. Need at minimum: (1) tags — mulch record database --type convention --tags 'fts5,search' ..., (2) tag-based query — mulch query database --tag fts5, (3) optionally, explicit relationships like 'this failure led to this convention'. Even simple tags would enable cross-cutting queries like 'everything about FTS5'.","design":"Freeform --tags flag on mulch record. Tags are just string arrays, no controlled vocabulary, no validation. mulch search --tag fts5 filters records where tags includes value. Bad tags are noise not errors. Content search from #2 catches inconsistent tagging anyway.","status":"closed","priority":2,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-09T17:02:02.691048-08:00","created_by":"Jaymin West","updated_at":"2026-02-09T17:26:08.664422-08:00","closed_at":"2026-02-09T17:26:08.664422-08:00","close_reason":"Closed"}
{"id":"mulch-feq","title":"mulch prime: multi-domain args and --domain flag form","description":"Single-domain scoping landed (mulch prime cli), but multi-agent architectures need: (1) multiple domain args: mulch prime database api testing, (2) --domain flag form: mulch prime --domain database. Setup claude hook should support per-agent domain scoping rather than global all-domain priming.","status":"closed","priority":2,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-09T17:01:52.838212-08:00","created_by":"Jaymin West","updated_at":"2026-02-09T17:17:07.451494-08:00","closed_at":"2026-02-09T17:17:07.451494-08:00","close_reason":"Closed"}
{"id":"mulch-gqy","title":"Add search/filter to mulch query","description":"mulch query dumps every record in a domain. Need: (1) mulch query --search 'FTS5' — find across all domains, (2) mulch query database --search 'WAL' — find within domain. For projects with 15+ records per domain, agents shouldn't consume all records to find the one about WAL mode. Currently read-everything-or-nothing.","design":"New 'mulch search' command. Brute-force substring matching across parsed JSONL fields (case-insensitive). Match all string-valued fields — content, description, name, title, rationale, resolution. CLI: mulch search \"FTS5\" (all domains), mulch search \"FTS5\" --domain database (scoped), mulch search \"FTS5\" --type failure (by type). Format matches same as mulch query. No index, no FTS, no embeddings. Sub-millisecond for \u003c1000 records.","status":"closed","priority":2,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-09T17:01:54.890857-08:00","created_by":"Jaymin West","updated_at":"2026-02-09T17:08:52.142069-08:00","closed_at":"2026-02-09T17:08:52.142069-08:00","close_reason":"Added mulch search command with case-insensitive substring matching across all string fields. Supports --domain and --type filters. 10 new tests."}
{"id":"mulch-hyz","title":"Implement --full, --mcp, --export flags for mulch prime","description":"prime.ts declares --full, --mcp, and --export options but the action handler ignores them (_options unused). Implement: --full skips summarization and outputs all entries, --mcp outputs JSON for MCP tool responses, --export writes output to a file path.","status":"closed","priority":2,"issue_type":"task","owner":"jayminwest@gmail.com","created_at":"2026-02-09T16:37:23.876536-08:00","created_by":"Jaymin West","updated_at":"2026-02-09T16:39:08.817962-08:00","closed_at":"2026-02-09T16:39:08.817962-08:00","close_reason":"Implemented --full (shows classification + evidence), --mcp (JSON output), --export \u003cpath\u003e (write to file)"}
{"id":"mulch-izw","title":"mulch init should be idempotent — re-run initMulchDir even when .mulch/ exists","description":"Currently `mulch init` bails early with '.mulch/ already exists' if the directory is present. This means newly added init-time artifacts (like .gitattributes merge=union line or .mulch/README.md) don't get created for existing projects. The init command should re-run initMulchDir() to fill in missing pieces idempotently, since initMulchDir() already handles all the skip-if-present logic internally.","status":"closed","priority":2,"issue_type":"task","owner":"jayminwest@gmail.com","created_at":"2026-02-09T16:31:59.306989-08:00","created_by":"Jaymin West","updated_at":"2026-02-09T16:35:33.440758-08:00","closed_at":"2026-02-09T16:35:33.440758-08:00","close_reason":"Made init idempotent — always runs initMulchDir, skips config/readme overwrite if already present"}
{"id":"mulch-jam","title":"Make search query optional for type-only filtering","status":"closed","priority":2,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-09T17:23:17.191249-08:00","created_by":"Jaymin West","updated_at":"2026-02-09T17:25:39.894799-08:00","closed_at":"2026-02-09T17:25:39.894799-08:00","close_reason":"Closed"}
{"id":"mulch-k9j","title":"Add mulch doctor command","description":"Single command for all health checks with --fix to auto-repair. Consolidates: schema validation (currently validate), stale record detection, orphaned domain detection, duplicate detection, config verification, JSONL integrity checks. Like bd doctor — one discoverable place for all health operations. Agents run mulch doctor and know if everything is healthy. --fix repairs what it can automatically.","status":"closed","priority":1,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-10T10:14:30.057166-08:00","created_by":"Jaymin West","updated_at":"2026-02-10T10:37:17.612295-08:00","closed_at":"2026-02-10T10:37:17.612295-08:00","close_reason":"Added mulch doctor with 7 health checks (config, JSONL integrity, schema validation, stale records, orphaned domains, duplicates, governance) and --fix auto-repair. Supports --json."}
{"id":"mulch-kl0","title":"Add mulch edit command for modifying existing records","description":"Currently records are append-only with no way to modify. Add 'mulch edit \u003cdomain\u003e \u003crecord-id\u003e' to update fields on an existing entry. Must preserve the JSONL format (rewrite the line in place).","status":"closed","priority":2,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-09T16:37:25.230685-08:00","created_by":"Jaymin West","updated_at":"2026-02-09T16:40:44.561897-08:00","closed_at":"2026-02-09T16:40:44.561897-08:00","close_reason":"Added mulch edit command with support for all record types, classification updates, and schema validation. 7 tests."}
{"id":"mulch-tul","title":"Context-aware priming","description":"mulch prime --context reads current git diff or staged files and filters expertise to only records relevant to those files. Keep it simple: match record file paths against changed files. No intent parsing, no semantic analysis. Just file-path intersection. If a record's files field mentions src/commands/record.ts and that file is in the diff, include it. Reduces context window waste without over-engineering.","status":"closed","priority":2,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-10T10:14:48.333205-08:00","created_by":"Jaymin West","updated_at":"2026-02-10T10:51:17.075736-08:00","closed_at":"2026-02-10T10:51:17.075736-08:00","close_reason":"Implemented --context flag on mulch prime. Extracts getChangedFiles/isGitRepo to src/utils/git.ts shared utility. filterByContext keeps records without files field (conventions, failures, decisions, guides) and filters pattern/reference records by file-path intersection with git changed files. 14 new tests, 278 total passing."}
{"id":"mulch-x5r","title":"Add mulch ready command","description":"Shows recently added/updated knowledge entries. Dead simple — no intent parsing, no domain inference, no smart context. Just answers: what's new or changed in expertise since last session? Sort by updated_at descending, show the most recent N records. Agents see what knowledge was captured recently and can build on it. Think git log for expertise.","status":"closed","priority":1,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-10T10:14:33.234457-08:00","created_by":"Jaymin West","updated_at":"2026-02-10T10:37:17.756714-08:00","closed_at":"2026-02-10T10:37:17.756714-08:00","close_reason":"Added mulch ready showing recent expertise entries sorted by recorded_at. Options: --limit, --domain, --since (duration parser). Supports --json."}
{"id":"mulch-y3w","title":"Quality-based governance beyond time expiry","description":"Governance is time-based only: tactical expires at 14 days, observational at 30. No way to mark a record as superseded, deprecated, or low-confidence. Time is a poor proxy for relevance — a 2-day-old observational record might be noise, while a 60-day-old tactical record might still be critical. Need: (1) manual status flags (superseded, deprecated, low-confidence), (2) ability to mark records as still-relevant to override time-based expiry, (3) prune should consider quality signals not just age.","design":"Three mechanisms, implement in order of value: (A) Supersede chains — mulch record --supersedes 4 marks record #4 as superseded_by new record, excluded from prime output but kept on disk. Agent-driven, explicit. (B) Evidence grounding — mulch prune --check-evidence flags records whose evidence files were deleted. Automated, extends validate. (C) Access-based decay — bump last_served on prime/query reads, mulch prune --unused 30 removes unserved records. Clever but adds state to read path. Start with A.","status":"in_progress","priority":2,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-09T17:02:05.204035-08:00","created_by":"Jaymin West","updated_at":"2026-02-10T08:13:58.444404-08:00"}
