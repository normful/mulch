{"id":"mulch-26n","title":"mulch prime should accept optional domain argument to scope output","description":"Currently mulch prime always outputs all domains. Add an optional positional argument (e.g. mulch prime cli) to output only that domain's expertise. Reduces context overload when agents only need one domain. Should validate the domain exists in config and error if not found.","status":"closed","priority":2,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-09T16:52:43.330753-08:00","created_by":"Jaymin West","updated_at":"2026-02-09T16:55:03.101817-08:00","closed_at":"2026-02-09T16:55:03.101817-08:00","close_reason":"Added optional [domain] positional argument to mulch prime. Validates domain exists in config, errors with available domains if not found. Updated README, .mulch/README, and init template. 4 new tests."}
{"id":"mulch-3kg","title":"Deduplication and idempotent recording","description":"mulch record always appends. Agents calling mulch record at session end will re-discover the same patterns and create duplicates. Need: (1) content-based dedup — skip if similar record exists, (2) named upsert — mulch record --name 'wal-mode' ... updates if exists, creates if not, (3) basic --if-not-exists flag. Without this, re-running seeding scripts or repeated agent sessions cause unbounded growth.","design":"Two dedup shapes: (A) exact re-discovery, (B) refined re-discovery. Named types (pattern/decision): upsert by name/title — if existing record matches, replace in place. Unnamed types (convention/failure): exact content/description match skips with message. --force flag overrides. ~30 lines in record command. No LLM needed.","status":"closed","priority":2,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-09T17:01:57.836585-08:00","created_by":"Jaymin West","updated_at":"2026-02-09T17:08:54.51354-08:00","closed_at":"2026-02-09T17:08:54.51354-08:00","close_reason":"Added dedup to mulch record. Named types (pattern/decision) upsert by name/title. Unnamed types (convention/failure) skip on exact content match. --force flag overrides. 10 new tests."}
{"id":"mulch-3m8","title":"Add reference and guide record types","description":"Current record types (convention/pattern/failure/decision) miss two common expertise categories: (1) key_files / reference — 'this file matters because...' e.g. 'app/src/mcp/tools.ts is the MCP tool definitions file', (2) key_operations / guide — step-by-step procedures like 'how to add an MCP tool'. These are frequently needed by agents and don't map cleanly to existing types.","design":"Two new record types: (1) reference — 'this file/concept matters because...', required fields: name, description, optional files array. (2) guide — 'here's how to do X', required fields: name, description. Both get classification like other types. reference is pattern-oriented around what matters; guide is convention-like but procedural. Simple schema additions.","status":"closed","priority":2,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-09T17:02:00.192715-08:00","created_by":"Jaymin West","updated_at":"2026-02-09T17:17:07.471479-08:00","closed_at":"2026-02-09T17:17:07.471479-08:00","close_reason":"Closed"}
{"id":"mulch-64w","title":"Provider-optimized prime output (XML for Claude, plain text for Codex)","description":"Design spec says Claude gets XML tags, Cursor gets markdown, Codex gets plain text. formatPrimeOutput currently only outputs markdown. Add --format flag or detect provider from setup config.","status":"closed","priority":3,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-09T16:37:26.04373-08:00","created_by":"Jaymin West","updated_at":"2026-02-09T16:42:31.364378-08:00","closed_at":"2026-02-09T16:42:31.364378-08:00","close_reason":"Added --format flag with xml (Claude-optimized), plain (Codex-optimized), and markdown (default). XML uses proper escaping and Claude-preferred tag structure."}
{"id":"mulch-9gb","title":"Fix flaky prune boundary test (tactical 14-day edge)","description":"test/commands/prune.test.ts 'tactical record exactly at boundary (14 days) is not pruned' fails intermittently. daysAgo(14) plus milliseconds of clock drift makes age 14.0000001, passing the \u003e 14 check. Fix: Math.floor the age-in-days computation in prune so boundary records are treated as exactly N whole days old.","status":"closed","priority":2,"issue_type":"bug","owner":"jayminwest@gmail.com","created_at":"2026-02-09T17:18:45.208441-08:00","created_by":"Jaymin West","updated_at":"2026-02-09T17:20:49.425797-08:00","closed_at":"2026-02-09T17:20:49.425797-08:00","close_reason":"Closed"}
{"id":"mulch-ecu","title":"Record relationships: tags and grouping","description":"Records are flat and isolated. A decision often explains why a convention exists; a failure often leads to a new pattern. Need at minimum: (1) tags — mulch record database --type convention --tags 'fts5,search' ..., (2) tag-based query — mulch query database --tag fts5, (3) optionally, explicit relationships like 'this failure led to this convention'. Even simple tags would enable cross-cutting queries like 'everything about FTS5'.","design":"Freeform --tags flag on mulch record. Tags are just string arrays, no controlled vocabulary, no validation. mulch search --tag fts5 filters records where tags includes value. Bad tags are noise not errors. Content search from #2 catches inconsistent tagging anyway.","status":"open","priority":2,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-09T17:02:02.691048-08:00","created_by":"Jaymin West","updated_at":"2026-02-09T17:06:01.123273-08:00"}
{"id":"mulch-feq","title":"mulch prime: multi-domain args and --domain flag form","description":"Single-domain scoping landed (mulch prime cli), but multi-agent architectures need: (1) multiple domain args: mulch prime database api testing, (2) --domain flag form: mulch prime --domain database. Setup claude hook should support per-agent domain scoping rather than global all-domain priming.","status":"closed","priority":2,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-09T17:01:52.838212-08:00","created_by":"Jaymin West","updated_at":"2026-02-09T17:17:07.451494-08:00","closed_at":"2026-02-09T17:17:07.451494-08:00","close_reason":"Closed"}
{"id":"mulch-gqy","title":"Add search/filter to mulch query","description":"mulch query dumps every record in a domain. Need: (1) mulch query --search 'FTS5' — find across all domains, (2) mulch query database --search 'WAL' — find within domain. For projects with 15+ records per domain, agents shouldn't consume all records to find the one about WAL mode. Currently read-everything-or-nothing.","design":"New 'mulch search' command. Brute-force substring matching across parsed JSONL fields (case-insensitive). Match all string-valued fields — content, description, name, title, rationale, resolution. CLI: mulch search \"FTS5\" (all domains), mulch search \"FTS5\" --domain database (scoped), mulch search \"FTS5\" --type failure (by type). Format matches same as mulch query. No index, no FTS, no embeddings. Sub-millisecond for \u003c1000 records.","status":"closed","priority":2,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-09T17:01:54.890857-08:00","created_by":"Jaymin West","updated_at":"2026-02-09T17:08:52.142069-08:00","closed_at":"2026-02-09T17:08:52.142069-08:00","close_reason":"Added mulch search command with case-insensitive substring matching across all string fields. Supports --domain and --type filters. 10 new tests."}
{"id":"mulch-hyz","title":"Implement --full, --mcp, --export flags for mulch prime","description":"prime.ts declares --full, --mcp, and --export options but the action handler ignores them (_options unused). Implement: --full skips summarization and outputs all entries, --mcp outputs JSON for MCP tool responses, --export writes output to a file path.","status":"closed","priority":2,"issue_type":"task","owner":"jayminwest@gmail.com","created_at":"2026-02-09T16:37:23.876536-08:00","created_by":"Jaymin West","updated_at":"2026-02-09T16:39:08.817962-08:00","closed_at":"2026-02-09T16:39:08.817962-08:00","close_reason":"Implemented --full (shows classification + evidence), --mcp (JSON output), --export \u003cpath\u003e (write to file)"}
{"id":"mulch-izw","title":"mulch init should be idempotent — re-run initMulchDir even when .mulch/ exists","description":"Currently `mulch init` bails early with '.mulch/ already exists' if the directory is present. This means newly added init-time artifacts (like .gitattributes merge=union line or .mulch/README.md) don't get created for existing projects. The init command should re-run initMulchDir() to fill in missing pieces idempotently, since initMulchDir() already handles all the skip-if-present logic internally.","status":"closed","priority":2,"issue_type":"task","owner":"jayminwest@gmail.com","created_at":"2026-02-09T16:31:59.306989-08:00","created_by":"Jaymin West","updated_at":"2026-02-09T16:35:33.440758-08:00","closed_at":"2026-02-09T16:35:33.440758-08:00","close_reason":"Made init idempotent — always runs initMulchDir, skips config/readme overwrite if already present"}
{"id":"mulch-kl0","title":"Add mulch edit command for modifying existing records","description":"Currently records are append-only with no way to modify. Add 'mulch edit \u003cdomain\u003e \u003crecord-id\u003e' to update fields on an existing entry. Must preserve the JSONL format (rewrite the line in place).","status":"closed","priority":2,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-09T16:37:25.230685-08:00","created_by":"Jaymin West","updated_at":"2026-02-09T16:40:44.561897-08:00","closed_at":"2026-02-09T16:40:44.561897-08:00","close_reason":"Added mulch edit command with support for all record types, classification updates, and schema validation. 7 tests."}
{"id":"mulch-y3w","title":"Quality-based governance beyond time expiry","description":"Governance is time-based only: tactical expires at 14 days, observational at 30. No way to mark a record as superseded, deprecated, or low-confidence. Time is a poor proxy for relevance — a 2-day-old observational record might be noise, while a 60-day-old tactical record might still be critical. Need: (1) manual status flags (superseded, deprecated, low-confidence), (2) ability to mark records as still-relevant to override time-based expiry, (3) prune should consider quality signals not just age.","design":"Three mechanisms, implement in order of value: (A) Supersede chains — mulch record --supersedes 4 marks record #4 as superseded_by new record, excluded from prime output but kept on disk. Agent-driven, explicit. (B) Evidence grounding — mulch prune --check-evidence flags records whose evidence files were deleted. Automated, extends validate. (C) Access-based decay — bump last_served on prime/query reads, mulch prune --unused 30 removes unserved records. Clever but adds state to read path. Start with A.","status":"open","priority":2,"issue_type":"feature","owner":"jayminwest@gmail.com","created_at":"2026-02-09T17:02:05.204035-08:00","created_by":"Jaymin West","updated_at":"2026-02-09T17:06:03.980381-08:00"}
