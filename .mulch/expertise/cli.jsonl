{"type":"pattern","name":"init-artifacts","description":"mulch init creates .mulch/, config, .gitattributes (merge=union for JSONL), and .mulch/README.md — modeled after Beads' bd init pattern","classification":"foundational","recorded_at":"2026-02-10T00:33:16.583Z","files":["src/utils/config.ts"]}
{"type":"pattern","name":"git-hook-markers","description":"Git hooks use # mulch:start / # mulch:end markers for safe append/remove in .git/hooks/pre-commit, same marker pattern as HTML comments in AGENTS.md sections","classification":"tactical","recorded_at":"2026-02-10T00:33:18.159Z","files":["src/commands/setup.ts"]}
{"type":"pattern","name":"idempotent-init","description":"initMulchDir uses existsSync guards for config and README so re-running init fills missing artifacts without overwriting user customizations","classification":"tactical","recorded_at":"2026-02-10T00:35:37.172Z","files":["src/utils/config.ts","src/commands/init.ts"]}
{"type":"pattern","name":"edit-by-index","description":"mulch edit uses 1-based JSONL line indices to identify records. Reads all records, mutates the target, validates with Ajv, then rewrites the whole file via writeExpertiseFile.","classification":"tactical","recorded_at":"2026-02-10T00:40:55.350Z","files":["src/commands/edit.ts"]}
{"type":"pattern","name":"commander-optional-arg-with-options","description":"When Commander has both a positional [arg] and options, the action callback receives (arg, options) — positional first, options second. See mulch prime implementation.","classification":"tactical","recorded_at":"2026-02-10T00:55:05.476Z","files":["src/commands/prime.ts"]}
{"type":"pattern","name":"search-brute-force","description":"mulch search does case-insensitive substring match across all string-valued fields via Object.values(). No index needed for <1000 records. Filters: --domain, --type.","classification":"tactical","recorded_at":"2026-02-10T01:09:20.659Z","files":["src/commands/search.ts","src/utils/expertise.ts"]}
{"type":"pattern","name":"record-dedup","description":"mulch record checks for duplicates before appending. Named types (pattern/decision) upsert by name/title. Unnamed types (convention/failure) skip on exact content/description match. --force overrides.","classification":"tactical","recorded_at":"2026-02-10T01:09:21.633Z","files":["src/commands/record.ts","src/utils/expertise.ts"]}
{"type":"reference","name":"cli-entry","description":"Main CLI entry point","classification":"tactical","recorded_at":"2026-02-10T01:16:20.884Z","files":["src/cli.ts"]}
{"type":"guide","name":"add-command","description":"How to add a new CLI command: create src/commands/<name>.ts, export register<Name>Command, register in src/cli.ts","classification":"tactical","recorded_at":"2026-02-10T01:16:26.826Z"}
{"type":"pattern","name":"variadic-commander-args","description":"Commander.js [args...] creates a string[] parameter. Combine with --option <vals...> by merging arrays and deduplicating with new Set(). Action callback receives (string[], options).","classification":"tactical","recorded_at":"2026-02-10T01:16:55.126Z","files":["src/commands/prime.ts"]}
{"type":"pattern","name":"type-extensible-records","description":"Adding record types follows a checklist: (1) record.ts types, (2) record-schema.ts oneOf, (3) record.ts command switch, (4) edit.ts switch, (5) expertise.ts findDuplicate, (6) format.ts formatters (md/xml/plain), (7) search.ts choices. Named types (pattern/decision/reference/guide) upsert by name; unnamed (convention/failure) skip on exact match.","classification":"tactical","recorded_at":"2026-02-10T01:16:58.885Z","files":["src/schemas/record.ts","src/schemas/record-schema.ts","src/commands/record.ts","src/utils/format.ts"]}
